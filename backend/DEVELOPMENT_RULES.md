# iloveresume 개발 규칙

## 프로젝트 개요
- **목적**: AI 기반 자기소개서 생성 서비스
- **기술 스택**: Flask (백엔드), React (프론트엔드), Google Vertex AI Gemini 2.0 Flash
- **데이터베이스**: SQLite + SQLAlchemy + Alembic

## 핵심 원칙

### 비용 최적화
1. **AI 모델 호출 최소화**: 1회 사용당 1회의 모델 호출만 허용 (배치 처리)
2. **OCR 최적화**: 텍스트가 충분한 경우 OCR 건너뛰기
3. **단일 이미지 OCR**: OCR 실행 시 가장 관련성 높은 단 하나의 이미지만 선별하여 처리

### 지원 사이트 정책
1. **링커리어 차단**: `https://linkareer.com/` 또는 `http://linkareer.com/`로 시작하는 URL은 차단
   - 사용자에게 "링커리어 채용공고는 아직 지원하지 않아요." 메시지 표시
   - HTTP 400 상태 코드 반환

2. **하이브리드 URL 검증 시스템**: 모든 채용공고 사이트 지원
   - **1단계**: 주요 플랫폼 URL 패턴 검사 (원티드, 사람인, 프로그래머스 등)
   - **2단계**: 일반 키워드 URL 패턴 검사 (careers, jobs, recruit 등)
   - **3단계**: 웹 크롤링 및 콘텐츠 분석 (JSON-LD 스키마, 키워드 분석)
   - 기업 자체 채용공고 페이지도 지원

## 채용공고 직무 추출 시스템 (간소화된 7단계 로직)

### 기존 복잡한 시스템 폐지
- 기존의 복잡한 구조화 및 키워드 매칭 방식 폐지
- 페이지 제목 위주의 직관적인 접근 방식으로 대체

### 새로운 사용자 직접 입력 방식 (v2.0)
1. **채용정보 직접 입력**: 사용자가 회사명, 직무, 주요업무, 자격요건, 우대사항을 직접 입력
2. **구조화된 데이터 저장**: 입력된 정보를 데이터베이스에 구조화하여 저장
3. **AI 기반 자기소개서 생성**: 입력된 정보와 이력서를 바탕으로 맞춤형 자기소개서 생성
4. **버전 관리**: 답변 수정 시 이전 버전 보존

### 주요 변경사항
- **크롤링 기능 완전 제거**: 웹 크롤링 관련 모든 기능 제거
- **사용자 직접 입력**: 채용정보를 사용자가 직접 입력하는 방식으로 전환
- **OCR 최적화**: 파일 업로드 시 비용 효율적인 텍스트 추출
- **향상된 데이터 구조**: 회사명, 직무, 주요업무 등 구조화된 데이터 저장

### 장점
- **정확성**: 사용자가 직접 입력하므로 더 정확한 정보 확보
- **안정성**: 웹 크롤링의 불안정성 제거
- **비용 효율성**: OCR 사용 최소화로 비용 절감
- **사용자 경험**: 단계별 입력으로 명확한 프로세스
- **확장성**: 다양한 채용정보 형식에 유연하게 대응

## Error Handling
- **APIError**: 사용자 정의 API 오류 클래스
- **ValidationError**: 데이터 검증 오류
- **FileProcessingError**: 파일 처리 오류

## API Design
- **RESTful 구조**: 표준 HTTP 메서드 사용
- **일관된 응답 형식**: JSON 기반 통일된 응답 구조
- **상태 코드 활용**: 적절한 HTTP 상태 코드 반환
- **에러 메시지**: 사용자 친화적인 오류 메시지

## Environment Variables
- **DATABASE_URL**: 데이터베이스 연결 문자열
- **PROJECT_ID**: GCP 프로젝트 ID
- **LOCATION**: Vertex AI 리전 (us-central1)
- **CORS_ORIGINS**: 허용된 프론트엔드 도메인
- **LOG_LEVEL**: 로깅 레벨 설정

## Code Quality
- **모듈화**: 기능별 서비스 분리 (AIService, OCRService, FileService)
- **설정 분리**: config 모듈로 환경 변수 관리
- **유틸리티 분리**: utils 모듈로 공통 기능 관리
- **로깅**: 구조화된 로깅 시스템
- **타입 힌트**: Python 타입 힌트 활용
- **예외 처리**: 적절한 예외 처리 및 오류 전파

## 개발 시 주의사항

### AI 모델 사용
- **배치 처리**: 여러 질문을 한 번에 처리하여 모델 호출 최소화
- **응답 파싱**: AI 응답의 구조화된 파싱 필수
- **오류 처리**: 모델 호출 실패 시 적절한 fallback

### 파일 처리
- **보안**: 업로드 파일 타입 및 크기 검증
- **성능**: 대용량 파일 처리 시 메모리 효율성 고려
- **정리**: 임시 파일 자동 삭제

### 데이터베이스
- **마이그레이션**: Alembic을 통한 스키마 변경 관리
- **트랜잭션**: 데이터 일관성을 위한 트랜잭션 처리
- **연결 관리**: 데이터베이스 연결 풀 관리

## 테스트 및 검증
- **Mock API**: 개발 환경에서의 API 모킹
- **단위 테스트**: 각 서비스별 독립적 테스트
- **통합 테스트**: 전체 워크플로우 테스트
- **성능 테스트**: 대용량 데이터 처리 성능 검증 